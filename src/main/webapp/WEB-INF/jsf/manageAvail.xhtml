<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml" xmlns:h="http://xmlns.jcp.org/jsf/html">
<h:head>
    <meta charset="UTF-8"/>
    <title>Manage Availability</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/semantic-ui/2.4.1/semantic.min.css"
          integrity="sha512-8bHTC73gkZ7rZ7vpqUQThUDhqcNFyYi2xgDgPDHc+GXVGHXq+xPjynxIopALmOPqzo9JZj0k6OqqewdGO3EsrQ=="
          crossorigin="anonymous" referrerpolicy="no-referrer"/>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js"
            integrity="sha512-894YE6QWD5I59HgZOGReFYm4dnWc1Qt5NtvYSaNcOP+u1T9qYdvdihz0PPSiiqn/+/3e7Jo4EaG7TubfWGUrMQ=="
            crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/semantic-ui/2.4.1/semantic.min.js"
            integrity="sha512-dqw6X88iGgZlTsONxZK9ePmJEFrmHwpuMrsUChjAw1mRUhUITE5QU9pkcSox+ynfLhL15Sv2al5A0LVyDCmtUw=="
            crossorigin="anonymous" referrerpolicy="no-referrer"></script>
</h:head>
<h:body>
    <div class="ui inverted huge top fixed menu">
        <div class="ui container">
            <a href="/" class="header item">
                APT
            </a>
            <a href="/appointments" class="item">Create Appointment</a>
            <div class="right menu">
                <a href="/account" class="item">
                    <i class="user icon"></i>
                </a>
            </div>
        </div>
    </div>
    <div class="ui container">
        <br/>
        <br/>
        <br/>
        <h1>Manage Availability</h1>
        <br/>
        <button class="ui green button" onclick="openModal()"> <i class="plus icon"></i> Create new</button>
        <h2 class="ui dividing header">Current Availabilities</h2>
        <form class="ui form">
            <div class="grouped fields" id="radioField">
                <label>Select lecturer?</label>
            </div>
        </form>

    </div>

    <div class="ui modal">
        <i class="close icon"></i>
        <div class="header">
            Create new availability
        </div>
        <div class="image content">
            <div class="description">
                <div class="ui header">We've auto-chosen a profile image for you.</div>
                <p>We've grabbed the following image from the <a href="https://www.gravatar.com" target="_blank">gravatar</a> image associated with your registered e-mail address.</p>
                <p>Is it okay to use this photo?</p>
            </div>
        </div>
        <div class="actions">
            <div class="ui black deny button">
                Nope
            </div>
            <div class="ui positive right labeled icon button">
                Yep, that's me
                <i class="checkmark icon"></i>
            </div>
        </div>
    </div>


    <script>

        $('.ui.basic.modal')
            .modal('show')
        ;

        let user;
        let avails;

        window.onload = async function() {
            const loadedUser = await getCurrentUser();
            avails = await getAvails(loadedUser.email);
            console.log(avails);
            user = loadedUser;
        }

        const getCurrentUser = async () => {
            const res = await fetch("/current-user");
            if(res.ok) {
                return await res.json();
            }
        }

        const getAvails = async (email) => {
            console.log(email);
            const res = await fetch('/availabilities/' + email);
            if(res.ok) {
                return await res.json();
            }
        }

        const openModal = () => {
            $('.ui.modal')
                .modal('show')
            ;
        }
    </script>
</h:body>
</html>